<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Listings</title>
    <link rel="stylesheet" href="Frontend/css/joblist.css">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const saveButtons = document.querySelectorAll('.save-btn');
            saveButtons.forEach(button => {
                button.addEventListener('click', () => {
                    button.classList.toggle('saved');
                    if (button.classList.contains('saved')) {
                        button.textContent = 'Saved';
                    } else {
                        button.textContent = 'Save';
                    }
                });
            });
        });
    </script>
</head>
<body>
    <header>
        <nav>
            <div class="logo">JobBridge (JobSeeker) </div>
            <ul>
                <li><a href="employee_homepage.html">Home</a></li>
                <li><a href="joblist.html">Job Listings</a></li>
                <li><a href="index.html">Register</a></li>
            </ul>
            <a href="employee_update_profile.html" class="btn-get-started text-end" id="myName"><img src="profilepic.jpg" alt="Small image" class="small-image" id="myImage">User</a>
        </nav>
    </header>
    <main>
        <section id="job-listings" class="decorated-job-listings">
            <h2>Available Jobs</h2>
            <!-- Job listings will be loaded here -->
        </section>
        <div class="job-listings" id="jobList">
          <!-- Job 1 -->
          <div class="job-card">
              <div class="job-header">
                  <div class="job-logo">
                      <img src="./Frontend/images/logo-amazon.png" alt="Amazon">
                  </div>
                  <div class="job-info">
                      <h3>Amazon</h3>
                      <span>5 days ago</span>
                  </div>
                  <button class="save-btn">Save</button>
              </div>
              <h2>Senior UI/UX Designer</h2>
              <div class="job-tags">
                  <span>Part-time</span>
                  <span>Senior level</span>
              </div>
              <p>RM 30/hour</p>
              <p>San Francisco, CA</p>
              <a href="ApplyJob.html"><button class="apply-btn">Apply now</button></a>
          </div>

          <!-- Job 2 -->
          <div class="job-card">
            <div class="job-header">
                <div class="job-logo">
                    <img src="./Frontend/images/petronas.png" alt="Amazon">
                </div>
                <div class="job-info">
                    <h3>Petronas</h3>
                    <span>10 days ago</span>
                </div>
                <button class="save-btn">Save</button>
            </div>
            <h2>Junior Software Engineer</h2>
            <div class="job-tags">
                <span>Part-time</span>
                <span>Full-time</span>
                <span>Junior level</span>
            </div>
            <p>RM25/hour</p>
            <p>Kuala Lumpur, Malaysia</p>
            <a href="ApplyJob.html"><button class="apply-btn">Apply now</button></a>
          </div>

          <!-- Job 3 -->
          <div class="job-card">
            <div class="job-header">
                <div class="job-logo">
                    <img src="./Frontend/images/maybank.png" alt="Amazon">
              </div>
              <div class="job-info">
                  <h3>Maybank</h3>
                  <span>1 hour ago</span>
              </div>
              <button class="save-btn">Save</button>
          </div>
          <h2>Data Analyst</h2>
          <div class="job-tags">
              <span>Full-time</span>
              <span>Mid-level</span>
          </div>
          <p>RM 30/hour</p>
          <p>Kuala Lumpur, Malaysia</p>
          <a href="ApplyJob.html"><button class="apply-btn">Apply now</button></a>
          </div>

          <!-- Job 4 -->
          <div class="job-card">
              <div class="job-header">
                  <div class="job-logo">
                      <img src="./Frontend/images/airasia.png" alt="Amazon">
                  </div>
                  <div class="job-info">
                      <h3>AirAsia</h3>
                      <span>1 days ago</span>
                  </div>
                  <button class="save-btn">Save</button>
              </div>
              <h2>Product Manager</h2>
              <div class="job-tags">
                  <span>Full-time</span>
                  <span>Senior level</span>
              </div>
              <p>RM 35/hour</p>
              <p>Sepang, Malaysia</p>
              <a href="ApplyJob.html"><button class="apply-btn">Apply now</button></a>
          </div>

          <!-- Job 5 -->
          <div class="job-card">
            <div class="job-header">
                <div class="job-logo">
                    <img src="./Frontend/images/microsoft.png" alt="Amazon">
                </div>
                <div class="job-info">
                    <h3>Microsoft</h3>
                    <span>2 days ago</span>
                </div>
                <button class="save-btn">Save</button>
            </div>
            <h2>DevOps Engineer</h2>
            <div class="job-tags">
                <span>Full-time</span>
                <span>Mid-level</span>
            </div>
            <p>RM 28/hour</p>
            <p>Redmond, WA</p>
            <a href="ApplyJob.html"><button class="apply-btn">Apply now</button></a>
          </div>

          <!-- Job 6 -->
          <div class="job-card">
            <div class="job-header">
                <div class="job-logo">
                    <img src="./Frontend/images/netflix.png" alt="Amazon">
                </div>
                <div class="job-info">
                    <h3>Netflix</h3>
                    <span>5 hours ago</span>
                </div>
                <button class="save-btn">Save</button>
            </div>
            <h2>Backend Developer</h2>
            <div class="job-tags">
                <span>Part-time</span>
                <span>Full-time</span>
                <span>Junior level</span>
            </div>
            <p>RM 22/hour</p>
            <p>Los Gatos, CA</p>
            <a href="ApplyJob.html"><button class="apply-btn">Apply now</button></a>
          </div>

          <!-- add here to add more card for more job listings. -->
        </div>
    </main>
    <footer class="footer mt-auto py-3 d-xxl-block d-none">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <span class="text-muted">&copy; 2024 JobBridge</span>
                <ul class="list-inline mb-0">
                    <li class="list-inline-item"><a href="#" class="text-muted">User Agreement</a></li>
                    <li class="list-inline-item"><a href="#" class="text-muted">Privacy Policy</a></li>
                    <li class="list-inline-item"><a href="#" class="text-muted">Community Guidelines</a></li>
                    <li class="list-inline-item"><a href="#" class="text-muted">Cookie Policy</a></li>
                    <li class="list-inline-item"><a href="#" class="text-muted">Copyright Policy</a></li>
                    <li class="list-inline-item"><a href="#" class="text-muted">Send Feedback</a></li>
                    <li class="list-inline-item"><a href="#" class="text-muted">Language</a></li>
                </ul>
            </div>
        </div>
    </footer>

    <script>
        
        let jobs = [];

        async function fetchJobDetails() {
            try {
                const response = await fetch('./Backend/fetch_job.php', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                jobs = await response.json();
                renderJobDetails(jobs);
            } catch (error) {
                console.error('There was a problem with the fetch operation:', error);
            }
        }

        function renderJobDetails(jobs) {
            const jobListingDiv = document.getElementById('jobList');
            if (jobs.error) {
                jobListingDiv.innerHTML = `<div class="alert alert-danger">${jobs.error}</div>`;
            } else {
                let html = '';
                jobs.reverse().forEach(job => {
                    html += `
                        <div class="job-card">
                            <div class="job-header">
                                <div class="job-logo">
                                    <img src="data:image/jpeg;base64,${job.image}" alt="${job.company}">
                                </div>
                                <div class="job-info">
                                    <h3>${job.company}</h3>
                                    <span>5 days ago</span>
                                </div>
                            </div>
                            <h2>${job.job_title}</h2>
                            <div class="job-tags">
                                <span>${job.work_type}</span>
                                <span>${job.requirement}</span>
                            </div>
                            <p>RM${job.salary} per month</p>
                            <p>${job.location}</p>
                            <a href="ApplyJob.html"><button class="apply-btn">Apply now</button></a>
                        </div>
                    `;
                });
                jobListingDiv.innerHTML = html;
            }
        }

        document.addEventListener('DOMContentLoaded', fetchJobDetails);

    </script>
</body>
</html>